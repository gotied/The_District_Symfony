{% extends 'base.html.twig' %}

{% block title %}Commande
{% endblock %}

{% block body %}
	<pre>
  {{ dump(app.user) }}
</pre>
	<pre>
{{dump(app.session.get('panier'))}}
</pre>
	<pre>
  {{ dump(plat) }}
</pre>
{# <pre>
	{{ dump(user) }}
</pre> #}

	<div class="d-flex flex-wrap justify-content-center">
		{% for p in plat %}
			{% set panier = app.session.get('panier') %}
			{% set quantite = panier[p.id] %}
			{% set totalPrix = p.prix * quantite %}
			<div class="card my-5 pt-3 px-2 mx-5 col-3" style="width: 16rem; height: 25rem;" id="card-body2">
				<img src="{{ asset('img/food/') ~ p.image }}" class="img-fluid card-img-top" alt="{{ p.libelle }}" height="70%">
				<div class="card-body">
					<h5 class="card-title" id="card-text">{{ p.libelle }}</h5>
					<p class="card-text" id="card-text">
						<input type="hidden" name="prix" value="{{ p.prix }}">
						<span id="total_{{ p.id }}">{{ totalPrix }}</span>
						<br><br>
						<select name="quantite_{{ p.id }}" onchange="modifierTotal()">
							{% for q in 1..10 %}
								<option value="{{ q }}" {% if q == quantite %} selected {% endif %}>{{ q }}</option>
							{% endfor %}
						</select>
					</p>
				</div>
			</div>
		{% endfor %}


		<div class="card my-5 pt-3 px-2 mx-5 col-3" style="width: 20rem;" id="card-commande">
			<div class="card-body">
				<h5 class="card-title" id="card-text"></h5>
				<p class="card-text">
					<form action="#" method="post" enctype="multipart/form-data">
						<input type="hidden" name="id_user" value="{{ app.user.id }}">
						{% for p in plat %}
							<input type="hidden" name="id_plat" value="{{ p.id }}">
						{% endfor %}
						{# {% set etat = 1 %} 
						<input type="hidden" name="etat" value="{{ etat }}"> #}
						<input type="hidden" name="date" value="{{ date|date('Y-m-d')}}">
						<br><br>
						<br><label for="total">Total :</label><br>
						<input type="text" id="total" name="total" readonly>
						<br><br>
						<input type="reset" value="Annuler" id="btn-style-2"><br><br>
						<input class="btn" type="submit" value="Commander" id="btn-style">
					</form>
				</p>
			</div>
		</div>
	</div>

{# {{ form_start(form) }}
	{{ form_row(form.date_commande) }}
	{{ form_row(form.total) }}
	{{ form_row(form.etat) }}
	{{ form_row(form.utilisateur) }}
	{{ form_row(form.plat) }}
{{ form_end(form) }} #}
{% endblock %}
